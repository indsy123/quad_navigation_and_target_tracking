# quad_navigation_and_target_tracking
A ROS repository for receding horizon PX4 quad motion planning and DNN based target tracking 

A ROS repository for receding horizon PX4 quad motion planning and DNN based target tracking 
This repository contains the code for generating a multi-objective optimal control based trajectories (description to be added eventually), quadrotor control, 
SSD-Mobilenet based target tracking the Jackal (Clearpath robotics) and acquisition of radioation counts at the Gieger counter mounted on the quad. All the 
algorithms to detect a weak radiological materials are also included and automatically run when you run the corresponding launch file. 

The system is for a PX4 based drone and assumes that you have a PX4 drone that can communicate with an onboard computer that is powerful enough to run all 
the algorithms. Everything has been tested on 1) Intel NUC7I7DNBE Core i7-8650U Quad-core 1.90 GHz running ubuntu 16.04 and 2)Intel NUC7i5DNBE Core i5-7300U 
Dual-core 2.60 GHz running ubuntu 18.04. Other specifications were 128GB SSD and 16GB RAM. The control loop gives the command to PX4 at 30 Hz, the state estimator
runs at 30Hz while the target tracking FPS is 15Hz and 6Hz at i7 and i5 processors, respectively. 

The cameras used in state estimation is Intel Realsense d265 and the camera for pointcloud generation and feeding the data to target tracker was Intel Relasense 
d435. The target tracker runs SSD-mobilenet to detect the ground vehicle (jackal) and a kalam filter that uses bounding boxes generated by the network as 
measurement and returns the relative position of the target wrt the quad. These are used in the radiation detection algorithms. 

Note: The newer versions of Realsense cameras have higher resolution (instead of 640x480 that I have used) and therefore  you need to reduce the resolution of 
the images before feeding it to the neural network to get inference at the mentioned FPS (15Hz at i7 and 6Hz at i5). Supposedly these scripts can be used with 
tensorflow 2.0 but some tweaking might be required. The inference script runs in ROS framework.  


This package needs the following packages: 
1. PCL library (version 1.11 or above) 
2. GSL library (uses some functions for trajectory generation) 
3. Eigen3
4. OpenVINS ( A UD developed VI state estimation package that can be found at https://github.com/rpng/open_vins
5. Tensorflow 1.14 (ubuntu 16.04) and 1.15 (ubutu 18.04) 
6. Tensorflow models from https://github.com/tensorflow/models
7. Intel Realsense camera drivers


Instructions to install all these libraries are straightforward and can be found online. 

To install this package, navigate to your catkin_ws/src folder and then run: 

git clone https://github.com/indsy123/quad_navigation_and_target_tracking

cd ..

catkin build -DCMAKE_BUILD_TYPE=Release

All the parameters can be found in launch/param.yaml file. The launch files are: 

1. To run the planner for end to end navigation without the target and radiation detection:

roslaunch quad_navigation_and_target_tracking quadrotor_navigation.launch doRHP:=true

2. To run the navigation with target tracking but without the radiation detection part:

roslaunch quad_navigation_and_target_tracking quadrotor_navigation_movingtarget.launch moving_target:=true 

3. To run the navigation with target tracking and radiation detection: 

roslaunch quad_navigation_and_target_tracking quadrotor_navigation_detection.launch moving_target:=true 

The trajectory can be visualized in rviz by launch the "quadNavigation.rviz" file. 
